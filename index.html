<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delivery Log System</title>
    <link rel="stylesheet" href="style.css">
    <!-- PWA manifest -->
    <link rel="manifest" href="manifest.json">
</head>
<body>

<div class="container">
    <h2>Delivery Log System</h2>

    <button class="btn-grab" onclick="location.href='grab.html'">Grab</button>
    <button class="btn-panda" onclick="location.href='panda.html'">FoodPanda</button>
    <button class="back-btn" onclick="location.href='admin.html'">Admin</button>
    
    <!-- Install App Button -->
    <button id="installBtn" style="margin-top:20px; padding:12px 20px; font-size:18px; border-radius:12px; background:#00b140; color:white; border:none; cursor:pointer; display:none;">
        Install App
    </button>
</div>

<p style="margin-top: 20px; text-align:center; color:#999;">
    Click anywhere to go to Monitor (if app installed)
</p>

<script>
    // AUTO-OPEN monitor.html when installed as app
    if (window.matchMedia('(display-mode: standalone)').matches) {
        window.location.href = "monitor.html";
    }

    // Register service worker
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('Service Worker registered'))
        .catch(err => console.log('Service Worker registration failed:', err));
    }

    // PWA Install prompt
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault(); // prevent automatic prompt
        deferredPrompt = e;
        installBtn.style.display = 'inline-block'; // show button
    });

    installBtn.addEventListener('click', async () => {
        installBtn.style.display = 'none';
        if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            console.log('User response to install prompt:', outcome);
            deferredPrompt = null;
        }
    });
</script>

</body>
</html>

